{% extends "base.html" %}

{% block title %}
    Spotify Playlist Generator Using Billboard's Charts
{% endblock %}

{% block body %}
    <header>
        <h1>Spotify Playlist Generator</h1>
        <p>Generate playlists from billboard top 100 or something</p>
        {% if username %}
            <div class="user-info">
                {% if session.get('profile_pic') %}
                    <img src="{{ session.profile_pic }}" alt="Profile Picture" width="40">
                {% endif %}
                <span>Welcome, {{ username }}!</span>
            </div>
            <button onclick="window.location.href='/logout'">
                Logout
            </button>
        {% else %}
        <button onclick="window.location.href='/login'">
            Login with Spotify
        </button>
        {% endif %}

    </header>

    <main>
        <div id="results" style="display: none">
        </div>
        <div id="failedSongs" style="display: none">
        </div>
        <button id="gap" type="button" hidden>Generate Another Playlist</button>
        <div id="buttons" style="display: none">
        <button id="back" type="button">Back</button>
        <button id="regenerate" type="button">Generate Again</button>
        <button id="deleteChecked" type="button">Remove Selected Songs</button>
            {% if username %}
                <button id="add" type="button">Add to Spotify</button>
            {% else %}
            <button onclick="window.location.href='/login'">
                Login with Spotify to Add
            </button>
            {% endif %}
        </div>
        <form action="/generate" method="post" id="form">
            <div>
                <h2>Chart Type</h2>
                <select id="chart" name="chart" required>
                    <option disabled selected value="">Select Chart</option>
                    {% for title in chart_dict %}
                        {% if title == "Hot 100" %}
                        <option value="{{ title }}">{{ title }} (Recommended)</option>
                        {% else %}
                        <option value="{{ title }}">{{ title }}</option>
                        {% endif %}
                    {% endfor %}
                </select>
            </div>
            
            <div class="date" id="startDate" hidden>
                <h2>Start Date</h2>
                <input id="startDateInput" type="date" name="startDate" required>
            </div>
            
            <div class="date" id="endDate" hidden>
                <h2>End Date</h2>
                <input id="endDateInput" type="date" name="endDate" required>
            </div>
            
            <div>
                <h2>Name of Playlist</h2>
                <input type="text" id="playlistName" name="playlistName" placeholder="Best of 2025 Playlist">
            </div>
            
            <div>
                <h2>Amount of Songs</h2>
                <input type="number" min="1" max="100" id="songAmount" name="songAmount" step="1" required>
            </div>
            
            <br>
            
            <div>
                <button type="submit">Generate Playlist</button>
            </div>

            <br>

            <div>
                <button type="reset">Reset Fields</button>
            </div>
        </form>

        <div id="loading" style="display: none">

        </div>
    </main>

    <footer>
        <p>Copyright Patdabaker</p>
    </footer>
    
    <script>
        const chartRanges = {{ chart_dict | tojson }};
    </script>
    <script src="../static/main.js"></script>
{% endblock %}
