{% extends "base.html" %}

{% block title %}
    ChartSync – Billboard → Spotify Playlist Generator
{% endblock %}

{% block body %}
<header class="header">
    <div class="header-top">
        <div class="title-group">
            <h1 class="title">ChartSync</h1>
            <h2 class="subtitle">Billboard → Spotify Playlist Generator</h2>
        </div>
        <div class="user-info">
            {% if username %}
                {% if session.profile_pic %}
                    <img src="{{ session.profile_pic }}" alt="Profile Picture">
                {% endif %}
                <span>Welcome, {{ username }}!</span>
                <button onclick="window.location.href='/logout'">Logout</button>
            {% else %}
                <button onclick="window.location.href='/login'">Login with Spotify</button>
            {% endif %}
        </div>
    </div>

    <p class="header-subtitle">
        Your music, your rules — build playlists from decades of Billboard&trade; hits.
    </p>
</header>


    <main>
        <div id="results" style="display: none">
        </div>
        <div id="failedSongs" style="display: none">
        </div>
        <button id="gap" type="button" hidden>Generate Another Playlist</button>
        <div id="buttons" style="display: none">
        <button id="back" type="button">Back</button>
        <button id="regenerate" type="button">Generate Again</button>
        <button id="deleteChecked" type="button">Remove Selected Songs</button>
            {% if username %}
                <button id="add" type="button">Add to Spotify</button>
            {% else %}
            <button onclick="window.location.href='/login'">
                Login with Spotify to Add
            </button>
            {% endif %}
        </div>
        <form action="/generate" method="post" id="form">
            <div>
                <h2>Chart Name</h2>
                <select id="chart" name="chart" required>
                    <option disabled selected value="">Select Chart</option>
                    {% for title in chart_dict %}
                        {% if title == "Hot 100" %}
                        <option value="{{ title }}">{{ title }} (Recommended)</option>
                        {% else %}
                        <option value="{{ title }}">{{ title }}</option>
                        {% endif %}
                    {% endfor %}
                </select>
            </div>
            
            <div class="date" id="startDate" hidden>
                <h2>Start Date</h2>
                <input id="startDateInput" type="date" name="startDate" required>
            </div>
            
            <div class="date" id="endDate" hidden>
                <h2>End Date</h2>
                <input id="endDateInput" type="date" name="endDate" required>
            </div>
            
            <div>
                <h2>Name of Playlist</h2>
                <input type="text" id="playlistName" name="playlistName" placeholder="Best of 2025 Playlist">
            </div>
            
            <div>
                <h2>Amount of Songs</h2>
                <input type="number" min="1" max="100" id="songAmount" name="songAmount" step="1" required>
            </div>
            
            <br>
            
            <div>
                <button type="submit">Generate Playlist</button>
            </div>
            <div>
                <button type="reset">Reset Fields</button>
            </div>
        </form>

        <div id="loading" style="display: none">

        </div>
    </main>
    <script>
        const chartRanges = {{ chart_dict | tojson }};
    </script>
    <script src="../static/main.js"></script>
{% endblock %}
